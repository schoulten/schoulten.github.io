{
  "hash": "0aa77aa23a919d4103a345cc1ccde065",
  "result": {
    "markdown": "---\ntitle: \"Cálculo da taxa de juros real: ex post e ex ante\"\ndate: \"2021-02-24\"\ndate-modified: \"2023-03-09\"\nauthor: \"Fernando da Silva\"\ndescription: \"O porquê e o como de analisar o preço do dinheiro ao longo do tempo, com uma aplicação em R\"\ncategories: [Macroeconomics, Monetary Policy, R, Português]\nimage: \"imgs/conducao.png\"\naliases: \n  - /posts/macroeconomia/juro-real/index.html\n---\n\n\nO dinheiro existe há bastante tempo e, geralmente, pagamos para poder usar o dinheiro e/ou poupança de outra pessoa (afinal, não existe almoço grátis). O preço dessa troca, entre o credor e o devedor, é o que usualmente se chama de juros. Também é comum que essa taxa, chamada de juros nominal, seja positiva e definida como um referencial pelo Banco Central de cada país, constituindo um dos principais instrumentos de controle da inflação.\n\nSabendo que a taxa de juros nominal é um preço, logo, há motivos para deflacioná-lo por um índice de correção de preços como o IPCA, por exemplo, de forma semelhante ao que fazemos quando é necessário \"corrigir\" o valor de um imóvel que irá à venda. O resultado dessa operação é o que é chamado de taxa de juros real, ou seja, a taxa nominal deflacionada pela taxa de inflação.\n\nTambém é com a taxa de juros real, em conjunto com uma outra taxa — a taxa neutra, que é uma taxa de juros teórica, consistente com a estabilidade da inflação ao longo do tempo —, que é possível analisar a condução da política monetária de uma economia. A política monetária é dita \"contracionista\" quando a taxa de juros real está acima da taxa de juros neutra, ou seja, a autoridade monetária está com a taxa de juros em território que desincentiva a tomada de crédito, os investimentos e o consumo de maneira geral. Do contrário, a política monetária é dita \"expansionista\".\n\n## Conceitos ex-post e ex-ante\n\nExistem basicamente duas perspectivas sobre a taxa de juros real: pelo conceito ex-post e pelo conceito ex-ante. No primeiro caso olhamos o comportamento dos juros no período passado, geralmente usando valores acumulados em 12 meses, o que nos permite verificar a tendência de juros real da economia; enquanto que no segundo caso é o oposto, estamos interessados em verificar o comportamento do juros real à frente, tomando como base expectativas de agentes de mercado, assim é possível identificar como é esperado o comportamento dos juros no futuro.\n\nDe forma mais visual, esses conceitos podem se traduzir em uma realidade da economia do país bastante impressionante se olharmos um período de tempo suficientemente grande, conforme a imagem abaixo:\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-1-1.png){width=2400}\n:::\n:::\n\n\n## Cálculo do juros real\n\nPara chegar ao resultado que determina o juros real da economia usamos a **equação de Fisher**, através da fórmula bem simples a seguir:\n\n$$r = \\left(\\frac{1+i}{1+\\pi}\\right)-1$$\nOnde os termos significam:\n\n$r$ = taxa de juros real<br>\n$i$ = taxa de juros nominal<br>\n$\\pi$ = taxa de inflação\n\nNote que se os dados estiverem expressos em percentual (% a.m., % a.a., etc.), você deve dividir o termo correspondente por 100 na fórmula acima.\n\n## Juros real no Brasil\n\nExplicados brevemente estes conceitos e dado uma prévia do resultado que queremos chegar, podemos partir para uma aplicação do cálculo das taxas para a economia brasileira.\n\nNo caso da **taxa de juros real ex-ante**, opto aqui por utilizar a taxa do Swap DI-Pré 360 dias e as expectativas de IPCA esperado também de 1 ano à frente, provenientes da B3 e do boletim Focus/BCB respectivamente. Há outras maneiras de obter essa taxa, para uma discussão sobre o assunto recomendo [esse texto](https://blogdoibre.fgv.br/posts/juro-real-ex-ante-caindo-ou-subindo) do Bráulio Borges e Gilberto Borça Jr. Já no caso da **taxa de juros real ex-post** usamos a taxa Selic acumulada no mês anualizada em base de 252 dias úteis e o IPCA acumulado em 12 meses, provenientes do BCB e do IBGE respectivamente.\n\nO que é necessário agora é obter esses dados e aplicar a equação de Fisher. A obtenção dos dados é bastante simples e rápida usando a linguagem R. Vamos usar as API's de três fontes públicas de dados (IPEADATA, BCB e IBGE).\n\n### Pacotes\n\nPrimeiro carregamos os pacotes de R necessários (instale com `install.packages()` caso você não tenha algum instalado).\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Carregar pacotes\nlibrary(rbcb)\nlibrary(ipeadatar)\nlibrary(sidrar)\nlibrary()\nlibrary()\n```\n:::\n\n\n### Coleta de dados \n\nEm seguida utilizamos os parâmetros de cada API para obter os dados das fontes indicadas.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Expectativas IPCA em 12 meses\ndados_focus_12m <- rbcb::get_market_expectations(\n  type = \"inflation-12-months\", \n  indic = \"IPCA\",\n  start_date = \"1999-01-01\"\n  )\n\n# Swaps DI pré 360\ndados_ipea <- ipeadatar::ipeadata(\"BMF12_SWAPDI36012\")\n\n# SELIC acumulada no mês anualizada base 252\ndados_selic <- rbcb::get_series(code = c(\"selic\" = 4189))\n\n# IPCA acumulado em 12 meses\ndados_ipca <- sidrar::get_sidra(api = \"/t/1737/n1/all/v/2265/p/all/d/v2265%202\")\n```\n:::\n\n\n### Tratamento de dados\n\nOs dados coletados precisam de alguns tratamentos para ficarem no formato desejado, o que envolve cruzar as tabelas, calcular médias, filtrar observações, etc.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Swaps DI pré 360\nswaps <- dplyr::select(dados_ipea, \"data\" = \"date\", \"swaps\" = \"value\")\n\n# Expectativa média do IPCA em 12 meses\nfocus_12m <- dados_focus_12m |>\n  dplyr::filter(baseCalculo == 0 & Suavizada == \"S\") |>\n  dplyr::group_by(data = lubridate::floor_date(Data, unit = \"month\")) |>\n  dplyr::summarise(ipca_exp = mean(x = Mediana, na.rm = TRUE))\n\n# SELIC acumulada no mês anualizada base 252\nselic <- dplyr::rename(dados_selic, \"data\" = \"date\")\n\n# IPCA acumulado em 12 meses\nipca <- dados_ipca |> \n  dplyr::mutate(\n    data     = lubridate::ym(`Mês (Código)`),\n    ipca_obs = Valor,\n    .keep    = \"none\"\n    ) |> \n  dplyr::as_tibble()\n\n# Cruzar tabelas\ntabelas <- purrr::reduce(\n  .x = list(swaps, focus_12m, selic, ipca),\n  .f = dplyr::full_join,\n  by = \"data\"\n  ) |> \n  dplyr::arrange(data) |> \n  dplyr::filter(data >= lubridate::ymd(\"2001-12-01\"))\n\n# Exibe dados\ntail(tabelas)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 5\n  data       swaps ipca_exp selic ipca_obs\n  <date>     <dbl>    <dbl> <dbl>    <dbl>\n1 2022-10-01  13.2     5.17  13.6     6.47\n2 2022-11-01  13.9     5.19  13.6     5.9 \n3 2022-12-01  13.8     5.26  13.6     5.79\n4 2023-01-01  13.5     5.41  13.6     5.77\n5 2023-02-01  13.4     5.66  13.6     5.6 \n6 2023-03-01  NA       5.59  13.6    NA   \n```\n:::\n:::\n\n\n### Calcular o juros real\n\nCom os dados em mãos, podemos finalmente aplicar a equação de Fisher. O resultado final será uma tabela com uma coluna com o período da observação, uma com o valor da taxa de juros real pelo conceito ex ante e outra pelo conceito ex-post.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Função útil para computar o cálculo\nfisher <- function(juros, inflacao) {\n  r = ((1 + juros) / (1 + inflacao)) - 1\n  return(r)\n}\n\n# Cálculo da taxa de juros real\njuros_real <- tabelas |> \n  dplyr::mutate(\n    ex_ante = fisher(juros = swaps/100, inflacao = ipca_exp/100) * 100,\n    ex_post = fisher(juros = selic/100, inflacao = ipca_obs/100) * 100,\n    data    = data,\n    .keep   = \"none\"\n    )\n\n# Exibe dados\ntail(juros_real)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 3\n  data       ex_ante ex_post\n  <date>       <dbl>   <dbl>\n1 2022-10-01    7.60    6.74\n2 2022-11-01    8.26    7.32\n3 2022-12-01    8.15    7.43\n4 2023-01-01    7.70    7.45\n5 2023-02-01    7.34    7.62\n6 2023-03-01   NA      NA   \n```\n:::\n:::\n\n\n### Extra: visualização de dados\n\nPor fim vamos gerar um gráfico que mostra a evolução das duas séries. Eu gosto muito do pacote `{ggplot2}`, dá pra criar gráficos muito bonitos e com muita flexibilidade:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Gerar gráfico de linhas\njuros_real <- juros_real |>\n  tidyr::drop_na() |> \n  tidyr::pivot_longer(cols = -\"data\", names_to = \"conceito\", values_to = \"juros\") |> \n  dplyr::mutate(conceito = dplyr::if_else(conceito == \"ex_ante\", \"Ex ante\", \"Ex post\"))\n\nset.seed(1984)\nggplot2::ggplot(data = juros_real) +\n  ggplot2::aes(x = data, y = juros, color = conceito) +\n  ggplot2::geom_hline(yintercept = 0, linetype = \"dashed\") +\n  ggplot2::geom_line(size = 1) +\n  ggplot2::coord_cartesian(\n    clip = \"off\",\n    xlim = c(min(juros_real$data), max(juros_real$data) + months(12))\n    ) +\n  ggrepel::geom_label_repel(\n    data        = dplyr::filter(juros_real, data == max(data)),\n    mapping     = ggplot2::aes(\n      label = format(x = juros, big.mark = \".\", decimal.mark = \",\", digits = 2, nsmall = 2)\n      ),\n    show.legend    = FALSE,\n    nudge_x        = 70,\n    segment.colour = NA,\n    fontface       = \"bold\"\n    ) +\n  ggplot2::scale_color_manual(values = c(\"#282f6b\", \"#b22200\")) +\n  ggplot2::scale_x_date(breaks = \"3 years\", date_labels = \"%Y\") +\n  ggplot2::scale_y_continuous(labels = scales::label_percent(scale = 1, accuracy = 1)) +\n  ggplot2::labs(\n    title    = \"Brasil: taxa de juros real (% a.a.)\",\n    x        = NULL,\n    y        = NULL,\n    color    = NULL,\n    caption  = \"**Dados**: B3, BCB e IBGE | **Elaboração**: Fernando da Silva\"\n    ) +\n  ggplot2::theme_light(base_size = 16) +\n  ggplot2::theme(\n    plot.title      = ggplot2::element_text(face = \"bold\"),\n    plot.caption    = ggtext::element_textbox_simple(\n      margin = ggplot2::margin(10, 0, 0, 0)\n      ),\n    plot.title.position   = \"plot\",\n    plot.caption.position = \"plot\",\n    axis.text             = ggplot2::element_text(face = \"bold\"),\n    legend.text           = ggplot2::element_text(face = \"bold\"),\n    legend.position       = c(0.75, 0.9),\n    legend.key            = ggplot2::element_blank(),\n    legend.background     = ggplot2::element_blank(),\n    legend.direction      = \"horizontal\"\n    )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-6-1.png){width=2400}\n:::\n:::\n\n\nVoilà! Eis o gráfico com os resultados do cálculo de juros real pelos conceitos ex-ante e ex-post. Espero que esse conteúdo tenha sido útil ou interessante para você. Até mais!\n\n<details><summary>Informações da sessão</summary>\n\n<div style=\"font-size:14px;\">\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n```\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.2.1 (2022-06-23 ucrt)\n os       Windows 10 x64 (build 19045)\n system   x86_64, mingw32\n ui       RTerm\n language (EN)\n collate  Portuguese_Brazil.utf8\n ctype    Portuguese_Brazil.utf8\n tz       America/Sao_Paulo\n date     2023-03-10\n pandoc   2.19.2 @ C:/Program Files/RStudio/resources/app/bin/quarto/bin/tools/ (via rmarkdown)\n quarto   1.2.335 @ C:\\\\PROGRA~1\\\\Quarto\\\\bin\\\\quarto.exe\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package     * version    date (UTC) lib source\n assertthat    0.2.1      2019-03-21 [1] CRAN (R 4.2.1)\n cli           3.4.1      2022-09-23 [1] CRAN (R 4.2.1)\n colorspace    2.0-3      2022-02-21 [1] CRAN (R 4.2.1)\n curl          4.3.3      2022-10-06 [1] CRAN (R 4.2.1)\n DBI           1.1.3      2022-06-18 [1] CRAN (R 4.2.1)\n digest        0.6.29     2021-12-01 [1] CRAN (R 4.2.1)\n dplyr         1.0.10     2022-09-01 [1] CRAN (R 4.2.1)\n ellipsis      0.3.2      2021-04-29 [1] CRAN (R 4.2.1)\n evaluate      0.17       2022-10-07 [1] CRAN (R 4.2.1)\n fansi         1.0.3      2022-03-24 [1] CRAN (R 4.2.1)\n farver        2.1.1      2022-07-06 [1] CRAN (R 4.2.1)\n fastmap       1.1.0      2021-01-25 [1] CRAN (R 4.2.1)\n generics      0.1.3      2022-07-05 [1] CRAN (R 4.2.1)\n ggplot2       3.3.6      2022-05-03 [1] CRAN (R 4.2.1)\n ggrepel       0.9.1      2021-01-15 [1] CRAN (R 4.2.0)\n ggtext        0.1.2      2022-09-16 [1] CRAN (R 4.2.1)\n glue          1.6.2      2022-02-24 [1] CRAN (R 4.2.1)\n gridtext      0.1.4.9000 2022-06-07 [1] Github (wilkelab/gridtext@6192174)\n gtable        0.3.1      2022-09-01 [1] CRAN (R 4.2.1)\n htmltools     0.5.3      2022-07-18 [1] CRAN (R 4.2.1)\n htmlwidgets   1.5.4      2021-09-08 [1] CRAN (R 4.2.1)\n httr          1.4.5      2023-02-24 [1] CRAN (R 4.2.2)\n insight       0.19.0     2023-01-30 [1] CRAN (R 4.2.2)\n ipeadatar   * 0.1.6      2022-10-11 [1] Github (gomesleduardo/ipeadatar@9754e14)\n jsonlite      1.8.4      2022-12-06 [1] CRAN (R 4.2.2)\n knitr         1.40       2022-08-24 [1] CRAN (R 4.2.1)\n labeling      0.4.2      2020-10-20 [1] CRAN (R 4.2.0)\n lattice       0.20-45    2021-09-22 [2] CRAN (R 4.2.1)\n lifecycle     1.0.3      2022-10-07 [1] CRAN (R 4.2.1)\n lubridate     1.9.2      2023-02-10 [1] CRAN (R 4.2.2)\n magrittr      2.0.3      2022-03-30 [1] CRAN (R 4.2.1)\n markdown      1.1        2019-08-07 [1] CRAN (R 4.2.1)\n munsell       0.5.0      2018-06-12 [1] CRAN (R 4.2.1)\n pillar        1.8.1      2022-08-19 [1] CRAN (R 4.2.1)\n pkgconfig     2.0.3      2019-09-22 [1] CRAN (R 4.2.1)\n purrr         0.3.5      2022-10-06 [1] CRAN (R 4.2.1)\n R6            2.5.1      2021-08-19 [1] CRAN (R 4.2.1)\n rbcb        * 0.1.10     2022-03-30 [1] CRAN (R 4.2.1)\n Rcpp          1.0.9      2022-07-08 [1] CRAN (R 4.2.1)\n rjson         0.2.21     2022-01-09 [1] CRAN (R 4.2.0)\n rlang         1.0.6      2022-09-24 [1] CRAN (R 4.2.1)\n rmarkdown     2.17       2022-10-07 [1] CRAN (R 4.2.1)\n rstudioapi    0.14       2022-08-22 [1] CRAN (R 4.2.1)\n scales        1.2.1      2022-08-20 [1] CRAN (R 4.2.1)\n sessioninfo   1.2.2      2021-12-06 [1] CRAN (R 4.2.1)\n sidrar      * 0.2.9      2022-07-12 [1] CRAN (R 4.2.0)\n sjlabelled    1.2.0      2022-04-10 [1] CRAN (R 4.2.1)\n stringi       1.7.8      2022-07-11 [1] CRAN (R 4.2.1)\n stringr       1.5.0      2022-12-02 [1] CRAN (R 4.2.2)\n tibble        3.1.8      2022-07-22 [1] CRAN (R 4.2.1)\n tidyr         1.2.1      2022-09-08 [1] CRAN (R 4.2.1)\n tidyselect    1.2.0      2022-10-10 [1] CRAN (R 4.2.1)\n timechange    0.2.0      2023-01-11 [1] CRAN (R 4.2.2)\n utf8          1.2.2      2021-07-24 [1] CRAN (R 4.2.1)\n vctrs         0.5.1      2022-11-16 [1] CRAN (R 4.2.1)\n withr         2.5.0      2022-03-03 [1] CRAN (R 4.2.1)\n xfun          0.33       2022-09-12 [1] CRAN (R 4.2.1)\n xml2          1.3.3      2021-11-30 [1] CRAN (R 4.2.1)\n xts           0.13.0     2023-02-20 [1] CRAN (R 4.2.2)\n yaml          2.3.5      2022-02-21 [1] CRAN (R 4.2.1)\n zoo           1.8-11     2022-09-17 [1] CRAN (R 4.2.1)\n\n [1] C:/Users/ferna/AppData/Local/R/win-library/4.2\n [2] C:/Program Files/R/R-4.2.1/library\n\n──────────────────────────────────────────────────────────────────────────────\n```\n:::\n:::\n\n</div>\n\n</details>\n\n<div style=\"border-top: 1px solid #dee2e6; padding-top: 1rem;\">\n<!-- AddToAny BEGIN -->\n<strong>Compartilhar:</strong>\n<div class=\"a2a_kit a2a_kit_size_32 a2a_default_style\">\n<a class=\"a2a_button_email\"></a>\n<a class=\"a2a_button_facebook\"></a>\n<a class=\"a2a_button_mastodon\"></a>\n<a class=\"a2a_button_linkedin\"></a>\n<a class=\"a2a_button_twitter\"></a>\n<a class=\"a2a_button_whatsapp\"></a>\n</div>\n<script async src=\"https://static.addtoany.com/menu/page.js\"></script>\n<!-- AddToAny END -->\n</div>\n\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}